language: cpp

matrix:
  include:
    - os: linux
      addons:
        apt:
          packages:
            - liblapack-dev
      env: ENABLEDEBUG=true ENABLESTATIC=true
    - os: linux
      dist: bionic
      addons:
        apt:
          packages:
            - liblapack-dev
    - os: osx
      osx_image: xcode11.3
      env: 
        - MATRIX_EVAL="brew update && brew install bash && export CC=gcc-9 CXX=g++-9"
    - os: osx
      osx_image: xcode10
      env:
        - MATRIX_EVAL="brew update && brew install bash"
before_script:
  - export ENABLEDEBUG=${ENABLEDEBUG:-false}
  - export ENABLESTATIC=${ENABLESTATIC:-false}
  - eval "${MATRIX_EVAL}"
  - $CC --version
  - $CXX --version
script:
  - git clone --depth 1 --branch autotools-update https://github.com/coin-or-tools/Data-Sample
  - git clone --depth 1 --branch autotools-update https://github.com/coin-or/CoinUtils
  - pushd Data-Sample && ./configure --prefix=$HOME/install && make install && popd
  - pushd CoinUtils && ./configure --prefix=$HOME/install && make install && popd
  - mkdir build
  - pushd build
  - export CFGFLAGS=""
  - if $ENABLEDEBUG ; then CFGFLAGS="$CFGFLAGS --enable-debug" ; fi
  - if $ENABLESTATIC ; then CFGFLAGS="$CFGFLAGS --enable-static --disable-shared" ; fi
  - ../Osi/configure --prefix=$HOME/install $CFGFLAGS
  - make
  - make test
  - make install
